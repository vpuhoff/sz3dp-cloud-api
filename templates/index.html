<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>3D –ü—Ä–∏–Ω—Ç–µ—Ä - –°—Ç–∞—Ç—É—Å</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ -->
    
    <!-- PWA –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="3D Printer">
    
    <!-- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö -->
    <meta name="format-detection" content="telephone=no">
    
    <!-- PWA –º–∞–Ω–∏—Ñ–µ—Å—Ç -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>3D –ü—Ä–∏–Ω—Ç–µ—Ä - –°—Ç–∞—Ç—É—Å –ø–µ—á–∞—Ç–∏</h1>
            <div class="connection-status {{ 'connected' if data.connection_status == '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ' else 'disconnected' }}">
                {{ data.connection_status }}
            </div>
        </header>

        <main>
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏ -->
            <section class="model-info">
                <h2>–ú–æ–¥–µ–ª—å: {{ data.model_name }}</h2>
            </section>

            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–µ—á–∞—Ç–∏ -->
            <section class="progress-section">
                <div class="progress-circle">
                    <svg viewBox="0 0 100 100" class="progress-ring">
                        <circle
                            cx="50"
                            cy="50"
                            r="45"
                            fill="none"
                            stroke="#e0e0e0"
                            stroke-width="8"
                        />
                        <circle
                            cx="50"
                            cy="50"
                            r="45"
                            fill="none"
                            stroke="#4CAF50"
                            stroke-width="8"
                            stroke-linecap="round"
                            stroke-dasharray="{{ (data.progress_percent * 2.827) | round(2) }} 282.7"
                            stroke-dashoffset="0"
                            class="progress-bar"
                        />
                    </svg>
                    <div class="progress-text">
                        <div class="time-remaining">–í—Ä–µ–º—è –æ—Å—Ç–∞–ª–æ—Å—å</div>
                        <div class="time-value">{{ data.time_remaining }}</div>
                        <div class="progress-percent">{{ data.progress_percent }}%</div>
                    </div>
                </div>
            </section>

            <!-- –ö–∞–º–µ—Ä–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–∞ -->
            <section class="camera-section">
                <div class="camera-header">
                    <h3>üìπ –ö–∞–º–µ—Ä–∞ –ø—Ä–∏–Ω—Ç–µ—Ä–∞</h3>
                    <div class="camera-status {{ 'enabled' if data.camera_enabled else 'disabled' }}">
                        {{ '–ö–∞–º–µ—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞' if data.camera_enabled else '–ö–∞–º–µ—Ä–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞' }}
                    </div>
                </div>
                
                <div class="camera-container">
                    {% if data.camera_snapshot %}
                        <div class="camera-snapshot">
                            <img src="data:image/jpeg;base64,{{ data.camera_snapshot }}" 
                                 alt="–°–Ω–µ–ø—à–æ—Ç —Å –∫–∞–º–µ—Ä—ã –ø—Ä–∏–Ω—Ç–µ—Ä–∞" 
                                 class="snapshot-image"
                                 id="camera-image">
                        </div>
                    {% else %}
                        <div class="camera-placeholder">
                            <div class="placeholder-icon">üì∑</div>
                            <div class="placeholder-text">
                                {% if data.camera_enabled %}
                                    –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...
                                {% else %}
                                    –ö–∞–º–µ—Ä–∞ –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    
                    <div class="camera-controls">
                        <button id="enable-camera-btn" class="camera-button enable-button" 
                                title="–í–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É">
                            <span class="button-icon">üìπ</span>
                            <span class="button-text">–í–∫–ª—é—á–∏—Ç—å –∫–∞–º–µ—Ä—É</span>
                        </button>
                        
                        <button id="refresh-camera-btn" class="camera-button refresh-button" 
                                title="–û–±–Ω–æ–≤–∏—Ç—å —Å–Ω–µ–ø—à–æ—Ç">
                            <span class="button-icon">üîÑ</span>
                            <span class="button-text">–û–±–Ω–æ–≤–∏—Ç—å</span>
                        </button>
                        
                        <button id="test-camera-btn" class="camera-button test-button" 
                                title="–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–º–µ—Ä—É">
                            <span class="button-icon">üß™</span>
                            <span class="button-text">–¢–µ—Å—Ç</span>
                        </button>
                    </div>
                    
                    <div class="camera-info">
                        <p>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã: {{ data.snapshot_last_update }}</p>
                        <p>–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É</p>
                    </div>
                </div>
            </section>

            <!-- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–Ω—Ç–µ—Ä–∞ -->
            <section class="printer-params">
                <div class="param-grid">
                    <div class="param-item">
                        <div class="param-icon extruder-icon">üî•</div>
                        <div class="param-label">–≠–∫—Å—Ç—Ä—É–¥–µ—Ä</div>
                        <div class="param-value">
                            {{ data.extruder_temp.current }}¬∞C / {{ data.extruder_temp.target }}¬∞C
                        </div>
                    </div>

                    <div class="param-item">
                        <div class="param-icon bed-icon">üõèÔ∏è</div>
                        <div class="param-label">–°—Ç–æ–ª</div>
                        <div class="param-value">
                            {{ data.bed_temp.current }}¬∞C / {{ data.bed_temp.target }}¬∞C
                        </div>
                    </div>

                    <div class="param-item">
                        <div class="param-icon enclosure-icon">üö™</div>
                        <div class="param-label">–ö–æ—Ä–ø—É—Å</div>
                        <div class="param-value">{{ data.enclosure_status }}</div>
                    </div>

                    <div class="param-item">
                        <div class="param-icon filament-icon">üéØ</div>
                        <div class="param-label">–§–∏–ª–∞–º–µ–Ω—Ç</div>
                        <div class="param-value">{{ data.filament_status }}</div>
                    </div>
                </div>
            </section>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ -->
            <section class="update-info">
                <div class="update-content">
                    <div class="update-text">
                        <p>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: {{ data.last_update }}</p>
                        <p>–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥</p>
                    </div>
                    <div class="update-buttons">
                        <button id="fullscreen-btn" class="fullscreen-button" title="–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º">
                            <span class="fullscreen-icon">‚õ∂</span>
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
